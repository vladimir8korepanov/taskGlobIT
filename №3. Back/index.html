<html>
<head>
  <meta charset="utf-8">
  <title>Список сотрудников</title>
</head>
<body>
  <h2>Список сотрудников:</h2>

  <%
    try {
      // Получаю всех сотрудников
      var collaborators = XQuery("for $c in collaborators return $c");
      
      if (collaborators != undefined && collaborators != null) {
        var count = ArrayCount(collaborators);
        
        if (count > 0) {
          // Использую цикл for-in для итерации
          for (collab in collaborators) {
            if (collab.fullname != undefined && collab.fullname != null && collab.fullname != "") {
              Response.Write(collab.fullname + "<br/>");
            }
          }
        } else {
          Response.Write("Нет сотрудников в базе");
        }
      } else {
        Response.Write("Не удалось загрузить данные");
      }
    } catch (e) {
      Response.Write("<p style='color:red'>Ошибка: " + e + "</p>");
    }
  %>
</body>
</html>